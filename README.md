# Tourist agency consultant

## Требования к проекту

### Диаграмма вариантов использования для бота-консультанта турагентства  

#### Акторы (пользователи системы):  
1. Клиент – пользователь, который ищет информацию о турах, бронирует поездки, запрашивает помощь.  
2. Сотрудник турагентства – менеджер, который может обрабатывать сложные запросы, помогать клиентам.  
3. Система оплаты – внешний сервис, через который производится оплата туров.  
4. Внешние API (авиабилеты, отели, экскурсии, транспорт) – источники данных, откуда бот получает актуальную информацию.  

---

#### Основные сценарии использования:  

1. Консультация по турам  
   - Бот отвечает на вопросы о направлениях, климате, визах и условиях поездок.  

2. Подбор тура  
   - Бот запрашивает параметры (страна, даты, бюджет) и предлагает подходящие варианты.  
   - Использует фильтры (тип отдыха, уровень сервиса).  
   - Предоставляет фотографии, описание отелей, отзывы.  

3. Оформление бронирования  
   - Клиент выбирает тур и получает инструкцию по бронированию и оплате.   

4. Уточнение деталей бронирования  
   - Клиент может запросить более подробную информацию по своему бронированию.  
   - Бот предоставляет расписание, условия проживания, включённые услуги.  

5. Отмена тура и возврат денег  
   - Клиент получает пошаговую инструкцию по отмене тура.  
   - Бот передаёт запрос в службу поддержки или направляет к правилам возврата.  

6. Поддержка клиента  
   - Автоматические ответы на частые вопросы.  
   - Возможность подключения к сотруднику турагентства.  

7. Помощь с авиабилетами  
   - Бот предоставляет информацию о рейсах и помогает подобрать билет.  

8. Поиск маршрутов  
   - Клиент запрашивает маршрут от точки А до точки Б.  
   - Бот предлагает возможные маршруты, транспорт, время в пути.  

9. Достопримечательности и экскурсии  
   - Бот даёт информацию о туристических местах.  
   - Возможность фильтрации по типу развлечений.  
   - Предоставление фотографий, описаний, отзывов.  

10. Визовые требования  
   - Бот предоставляет список необходимых документов для визы.  
   - Дает ссылку на официальные источники и инструкции.  

11. Действия при потере багажа  
   - Бот объясняет последовательность действий при потере багажа.  
   - Предоставляет контакты аэропорта. 

12. Изменение даты тура  
   - Бот проверяет возможность переноса даты.  

13. Оставить отзыв о работе бота  
   - Клиент может оценить работу бота (от 1 до 5).  
   - Оставить комментарий, предложения по улучшению.  

---

### Связи между актёрами и вариантами использования:  
- Клиент взаимодействует со всеми основными функциями.  
- Сотрудник турагентства подключается в случае сложных запросов или изменений бронирования.  
- Система оплаты участвует в процессе оплаты.  
- Внешние API обеспечивают актуальные данные о билетах, отелях, маршрутах.  

## Архитектура проекта

Схемка:
```mermaid

flowchart LR
    subgraph User Interface
        tg_bot["bot in TG"]
    end

    subgraph external_services
        tavily_search["tavily search"]
        gigachat["gigachat"]
    end

    subgraph backend
        communication_server["communication-service"]
        postgresql_db[("communications DB")]
        ml_server["ml-service"]
        faiss[("FAISS")]
    end

    tg_bot -->|user requests| communication_server
    communication_server --> ml_server
    ml_server -->|search similar text request| faiss

    ml_server ----> tavily_search
    ml_server --> gigachat
    communication_server -->|store user feedback| postgresql_db

```
#### Команда для подключения к БД
```
psql "host=rc1a-tovlljfgcws5wj5h.mdb.yandexcloud.net,rc1b-2ijpl1ta0ep3wk3a.mdb.yandexcloud.net \
    port=6432 \
    sslmode=verify-full \
    dbname=communications \
    user=mirea_team \
    target_session_attrs=read-write"
```

ТГ бот на aiogram  
БД На postgresql  
TODO:  
1. разобраться с деплоем сервиса на севрере +
2. Разобраться с подключением к БД (и нужна ли она, и postgre ли нужна)  +
3. Разобраться с токеном ТГ бота (как прокинуть на сервер, чтобы не украли)
